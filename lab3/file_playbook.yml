---
- name: basic file operations
  hosts: my_servers
  connection: local
  gather_facts: no

  tasks:
    - name: create file
      shell: echo "test_file_content" > $HOME/test_from_playbook.txt
      args:
        executable: /bin/bash

    - name: verify file creation
      shell: cat $HOME/test_from_playbook.txt
      register: cat_result
      failed_when: cat_result.rc != 0
      
    - name: output cat
      debug:
        var: cat_result.stdout_lines

    - name: modify file content
      shell: echo "modified_file_content" > $HOME/test_from_playbook.txt
      args:
        executable: /bin/bash

    - name: verify file modification
      shell: cat $HOME/test_from_playbook.txt
      register: cat_mod_result
      failed_when: cat_result.rc != 0
      
    - name: output cat
      debug:
        var: cat_mod_result.stdout_lines

    - name: delete the file
      file:
        path: $HOME/test_from_playbook.txt
        state: absent

    - name: verify deletion
      stat:
        path: $HOME/test_from_playbook.txt
      register: stat_result

    - name: output stat
      debug:
        var: stat_result.stat.exists
